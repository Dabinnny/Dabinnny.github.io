{"componentChunkName":"component---src-templates-blog-post-js","path":"/DeepLearning/데이터증강/","result":{"data":{"site":{"siteMetadata":{"title":"DABI_devlog","author":"[DABIN SEO]","siteUrl":"https://Dabinnny.github.io","comment":{"disqusShortName":"","utterances":"Dabinnny/Dabinnny.github.io"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"d5d1ebe9-6669-511b-8d4a-d7bd3a861b9f","excerpt":"➕ 이미지야 늘어나라! 다양해져라! 1. 데이터 증강(Data Augmentation…","html":"<h1 id=\"-이미지야-늘어나라-다양해져라\" style=\"position:relative;\"><a href=\"#-%EC%9D%B4%EB%AF%B8%EC%A7%80%EC%95%BC-%EB%8A%98%EC%96%B4%EB%82%98%EB%9D%BC-%EB%8B%A4%EC%96%91%ED%95%B4%EC%A0%B8%EB%9D%BC\" aria-label=\" 이미지야 늘어나라 다양해져라 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>➕ 이미지야 늘어나라! 다양해져라!</h1>\n<h2 id=\"1-데이터-증강data-augmentation-이란\" style=\"position:relative;\"><a href=\"#1-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A6%9D%EA%B0%95data-augmentation-%EC%9D%B4%EB%9E%80\" aria-label=\"1 데이터 증강data augmentation 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 데이터 증강(Data Augmentation) 이란?</h2>\n<br/>\n<blockquote>\n<p>원본 데이터에 변환을 주어 데이터셋의 갯수를 증강시키는 기법</p>\n</blockquote>\n<br/>\n<p>이미지로 학습하는 모델의 경우 데이터가 충분하다면 더할나위 없이 좋겠지만,<br>\n원하는 이미지를 모델을 충분히 학습시킬 만큼 확보하는것은 쉽지가 않다.<br>\n이런경우 한정된 이미지 데이터를 증강기법을 통해 늘릴 수 있다.  </p>\n<div align=\"center\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 605px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3klEQVQoz2P4jwH+/f0FJL6+ffL908v//3///fXtPw7AgKrvH5B4e27Z0005Z9sNNhRpnZ0W+v7YJKI0//v3F0g+2Fx3d5rVzkKxWSFcC0IYzsyKhJtLWPOFZcWXJjse67RdHMkx1ZthTbXjX6jGf4Sd/enl7fcPz3x8cPrh2Z33z+758OgKcX5GAt9//v7268/3H79v3X34/Pmzv3//YtEMduo/qKtANkPd9uXL5+fPn9++ffvK5Us3b1z78P4dUBBkxN+//2D+x2Pzry9fvoK98g+ns1/dPPbz64e39y/d31BxcUn+u6e3f3/7+O7+uTd3z/769uX7pzePz255cf3I7YPLjs/O3j+r6NiCsgeba+/v7Pn07BbDkgTRO8vTb66tONxuPyWA+8i01Gfba/dU6c+Kkbu4pvnB2vwF0cJLs/VWZ8hP8OHs9OGfGMB3sNHsVJ/HqxtHGJanyZ+bGni413dXne3UYKHVuToXZ4TuababEiy8qcz82kz/xWmqa3O1zk72W52tXe0kMDFE8nif795u3+c3TzC8uHboxd2zz28cf3xu140T2x5c2P/89uk3d0/fOb3rzrmDb++dfXXrxP3z+9/cO/v21rFrR7ddObrj9a1jz26e/P7lHQDb2FpTxaj3SwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"au\" title=\"au\" src=\"/static/f4ef0275ac4eac7ed76ae840983bdfba/90cbd/au.png\" srcset=\"/static/f4ef0275ac4eac7ed76ae840983bdfba/5a46d/au.png 300w,\n/static/f4ef0275ac4eac7ed76ae840983bdfba/0a47e/au.png 600w,\n/static/f4ef0275ac4eac7ed76ae840983bdfba/90cbd/au.png 605w\" sizes=\"(max-width: 605px) 100vw, 605px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span> </div>   \n<p>위 사진은 우리 눈엔 다 똑같은 사자로 보이지 않는가?<br>\n하지만, 컴퓨터는 이미지를 숫자로 보기때문에 다 다른 데이터로 인식할 것이다.<br>\n이제 데이터를 추가 확보하는 귀찮음과 고생의 굴레에서 벗어나 보자.  </p>\n<h2 id=\"2-데이터-증강data-augmentation기법의-종류\" style=\"position:relative;\"><a href=\"#2-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A6%9D%EA%B0%95data-augmentation%EA%B8%B0%EB%B2%95%EC%9D%98-%EC%A2%85%EB%A5%98\" aria-label=\"2 데이터 증강data augmentation기법의 종류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 데이터 증강(Data Augmentation)기법의 종류</h2>\n<p>데이터증강 기법은 Tensorflow.keras에서 <code class=\"language-text\">ImageDataGenerator</code> 클래스를 통해 적용할 수 있다.<br>\nmethod 종류에 대해서 자세히 알아보자.  </p>\n<ul>\n<li><code class=\"language-text\">vertical_flip</code> : 수직(세로)으로 뒤집기(True)</li>\n<li><code class=\"language-text\">horizontal_flip</code> : 수평(가로)으로 뒤집기(True)</li>\n<li><code class=\"language-text\">validation_split</code> : 검증데이터 split 비율</li>\n<li><code class=\"language-text\">rescale</code> : 크기조절(default None)</li>\n<li><code class=\"language-text\">rotation_range</code> : 지정된 각도만큼 회전</li>\n<li><code class=\"language-text\">zoom_range</code> : 지정된 크기만큼 확대/축소</li>\n<li><code class=\"language-text\">width_shift_range</code> : 지정된 크기만큼 수평방향으로 이동</li>\n<li><code class=\"language-text\">hight_shift_range</code> : 지정된 크기만큼 수직방향으로 이동</li>\n<li><code class=\"language-text\">brightness_range</code> : 밝기를 랜덤으로 조절</li>\n</ul>\n<br/>\n<p>더 많은 method들은 <a href=\"https://keras.io/ko/preprocessing/image/\">keras 공식홈페이지</a>에서 알아볼 수 있다.  </p>\n<h2 id=\"2-데이터-증강data-augmentation-예제\" style=\"position:relative;\"><a href=\"#2-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A6%9D%EA%B0%95data-augmentation-%EC%98%88%EC%A0%9C\" aria-label=\"2 데이터 증강data augmentation 예제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 데이터 증강(Data Augmentation) 예제</h2>\n<p>자 그럼, 직접 실습을 해보자.  </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">import</span> load_img\n<span class=\"token keyword\">from</span> keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">import</span> img_to_array\n<span class=\"token keyword\">from</span> numpy <span class=\"token keyword\">import</span> expand_dims\n<span class=\"token keyword\">from</span> matplotlib <span class=\"token keyword\">import</span> pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>preprocessing<span class=\"token punctuation\">.</span>image <span class=\"token keyword\">import</span> ImageDataGenerator\n\nimg <span class=\"token operator\">=</span> load_img<span class=\"token punctuation\">(</span><span class=\"token string\">\".img/ice.jpeg\"</span><span class=\"token punctuation\">)</span>\n\ndata <span class=\"token operator\">=</span> img_to_array<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\nsamples <span class=\"token operator\">=</span> expand_dims<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\ndatagen <span class=\"token operator\">=</span> ImageDataGenerator<span class=\"token punctuation\">(</span>shear_range<span class=\"token operator\">=</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span>\n                             rotation_range<span class=\"token operator\">=</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n                             vertical_flip<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n                             width_shift_range<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>\n                             height_shift_range<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>\n                             brightness_range<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nit <span class=\"token operator\">=</span> datagen<span class=\"token punctuation\">.</span>flow<span class=\"token punctuation\">(</span>samples<span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    batch <span class=\"token operator\">=</span> it<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    image <span class=\"token operator\">=</span> batch<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'uint8'</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<div align=\"center\"><img src=\"https://user-images.githubusercontent.com/90162819/159122423-5b5b525a-084d-48e3-aaff-71f6e227332d.png\" width=\"600\"></div> \n<br/>\n<br/>\n<p>예제에서는 많은 변환을 주지 않아서 아이스크림의 본질을 잘 유지하고 있지만,<br>\n너무 많은 method를 한번에 여러가지를 주면 데이터의 본질이 흐려질 수도 있다.<br>\n적당히 변환결과를 보면서 적용해주자!  </p>\n<br/>\n<br/>\n<blockquote>\n<p><em>이 포스팅은 <a href=\"https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&#x26;blogId=isu112600&#x26;logNo=221582003889\">이 글</a>을 참고하였습니다.</em></p>\n</blockquote>","frontmatter":{"title":"Data Augmentation(데이터 증강) 파헤치기","date":"December 17, 2021"}}},"pageContext":{"slug":"/DeepLearning/데이터증강/","previous":{"fields":{"slug":"/MachineLearning/다중공선성/"},"frontmatter":{"title":"Multicollinearity(다중공선성) 문제와 해결하기"}},"next":{"fields":{"slug":"/OpenCV/기초함수(1)/"},"frontmatter":{"title":"OpenCV 기본함수 정리(1) - 이미지"}}}},"staticQueryHashes":["2486386679","3128451518"]}